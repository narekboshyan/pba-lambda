{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.211.0"},"children":{"Mp4ToHlsStack":{"id":"Mp4ToHlsStack","path":"Mp4ToHlsStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.211.0"},"children":{"InputBucket":{"id":"InputBucket","path":"Mp4ToHlsStack/InputBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]},"children":{"Notifications":{"id":"Notifications","path":"Mp4ToHlsStack/InputBucket/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/InputBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"AllowBucketNotificationsToMp4ToHlsStackTranscoderFnF36B2310":{"id":"AllowBucketNotificationsToMp4ToHlsStackTranscoderFnF36B2310","path":"Mp4ToHlsStack/InputBucket/AllowBucketNotificationsToMp4ToHlsStackTranscoderFnF36B2310","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["TranscoderFn0CD6748F","Arn"]},"principal":"s3.amazonaws.com","sourceAccount":"891377116317","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone"]]}}}}}},"OutputBucket":{"id":"OutputBucket","path":"Mp4ToHlsStack/OutputBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}},"MediaConvertRole":{"id":"MediaConvertRole","path":"Mp4ToHlsStack/MediaConvertRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[]},"children":{"ImportMediaConvertRole":{"id":"ImportMediaConvertRole","path":"Mp4ToHlsStack/MediaConvertRole/ImportMediaConvertRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":[]}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/MediaConvertRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"mediaconvert.amazonaws.com"}}],"Version":"2012-10-17"},"description":"Role used by AWS Elemental MediaConvert to read input and write outputs"}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"Mp4ToHlsStack/MediaConvertRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/MediaConvertRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:ListBucket","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone"]]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone/*"]]}},{"Action":"s3:PutObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone/*"]]}}],"Version":"2012-10-17"},"policyName":"MediaConvertRoleDefaultPolicy03164485","roles":[{"Ref":"MediaConvertRole031A64A9"}]}}}}}}},"TranscoderFn":{"id":"TranscoderFn","path":"Mp4ToHlsStack/TranscoderFn","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.211.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"Mp4ToHlsStack/TranscoderFn/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"Mp4ToHlsStack/TranscoderFn/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":[]}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/TranscoderFn/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"Mp4ToHlsStack/TranscoderFn/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/TranscoderFn/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["mediaconvert:DescribeEndpoints","mediaconvert:CreateJob","mediaconvert:GetJob"],"Effect":"Allow","Resource":"*"},{"Action":"iam:PassRole","Effect":"Allow","Resource":{"Fn::GetAtt":["MediaConvertRole031A64A9","Arn"]}},{"Action":"s3:ListBucket","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone"]]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone/*"]]}},{"Action":"s3:PutObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::pba-bucket-prod-clone/*"]]}}],"Version":"2012-10-17"},"policyName":"TranscoderFnServiceRoleDefaultPolicyEFE5E303","roles":[{"Ref":"TranscoderFnServiceRole6C1C41CF"}]}}}}}}},"Code":{"id":"Code","path":"Mp4ToHlsStack/TranscoderFn/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"Mp4ToHlsStack/TranscoderFn/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"Mp4ToHlsStack/TranscoderFn/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/TranscoderFn/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"architectures":["x86_64"],"code":{"s3Bucket":"cdk-hnb659fds-assets-891377116317-us-east-1","s3Key":"8c5b3f4ed892e5cde7b70160e2addc9e10fbd5c2e1fdd4ab84653d2a8bdecfe0.zip"},"environment":{"variables":{"MEDIACONVERT_ROLE_ARN":{"Fn::GetAtt":["MediaConvertRole031A64A9","Arn"]},"OUTPUT_BUCKET":"pba-bucket-prod-clone"}},"handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["TranscoderFnServiceRole6C1C41CF","Arn"]},"runtime":"nodejs20.x","timeout":60}}},"LogRetention":{"id":"LogRetention","path":"Mp4ToHlsStack/TranscoderFn/LogRetention","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogRetention","version":"2.211.0"},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/TranscoderFn/LogRetention/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"LogGroup":{"id":"LogGroup","path":"Mp4ToHlsStack/TranscoderFn/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":[]}}}},"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a":{"id":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Code":{"id":"Code","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.211.0"},"children":{"Stage":{"id":"Stage","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.211.0"}},"AssetBucket":{"id":"AssetBucket","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.211.0","metadata":[]}}}},"ServiceRole":{"id":"ServiceRole","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":[]}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:PutRetentionPolicy","logs:DeleteRetentionPolicy"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB","roles":[{"Ref":"LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"}]}}}}}}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Role":{"id":"Role","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.211.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.211.0","metadata":[]}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.211.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":"*"},{"Action":"s3:GetBucketNotification","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"Mp4ToHlsStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"TranscoderErrorsAlarm":{"id":"TranscoderErrorsAlarm","path":"Mp4ToHlsStack/TranscoderErrorsAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.211.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"Mp4ToHlsStack/TranscoderErrorsAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.211.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmDescription":"Lambda reported one or more errors in the last 5 minutes","comparisonOperator":"GreaterThanOrEqualToThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"TranscoderFn0CD6748F"}}],"evaluationPeriods":1,"metricName":"Errors","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"MediaConvertRoleArn":{"id":"MediaConvertRoleArn","path":"Mp4ToHlsStack/MediaConvertRoleArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.211.0"}},"LambdaName":{"id":"LambdaName","path":"Mp4ToHlsStack/LambdaName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.211.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"Mp4ToHlsStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"Mp4ToHlsStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.211.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"Mp4ToHlsStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.211.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"Mp4ToHlsStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.211.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}